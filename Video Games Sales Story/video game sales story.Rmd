---
title: "Video Game Sales Story"
output: html_document
author: Yun-Hsiang (Ray) Chan
---
Hi, This is Ray, a second-year Applied Statistics student at University of Toronto. The project you are reading now is one of my summer analysis projects. I call this series of projects "Data Story". In these projects, I will analyze the data and answer some interesting questions.

# Introduction of the dataset
```{r echo = T, results = 'hide'}
library(tidyverse)
library(knitr)
library(Hmisc)
video_game = read_csv('vgsales.csv')
na.omit(video_game)
```

```{r}
glimpse(video_game)
video_game[video_game == 'Sony Computer Entertainment Europe'] <- 'Sony Computer Entertainment'
levels(video_game$Genre)
head(video_game)
```

This is a dataset of video game sales obtained from Kaggle. The dataset are generated from vgchartz.com. There are 11 variables in the dataset, including rank, name platform, genre and so on. 

# Who is the most popular Publisher? 
```{r}
pub_rank <- video_game %>% 
  select(Publisher, Global_Sales) %>% 
  group_by(Publisher) %>%  
  summarise(mean_sale_publisher = mean(Global_Sales), 
            number_of_games = n()) %>% 
  arrange(desc(mean_sale_publisher))

pub_rank <- pub_rank %>% filter(number_of_games >= 10) %>% filter()
pub_rank_10 <- pub_rank[1:10, ]
knitr::kable(pub_rank_10)
```

A good publisher should be able to contiounsly develop games, so I only pick out the publishers who develop more than 10 games. Then I compute the mean sale of each publisher and show the best 10 publishers.

Undoubtedly, Nintendo is the best publisher in the world. It has the highest mean sale and develops the maximum number of games. Also, we know that Nintendo creates a bunch of famous games, such as Pokemon or Mario. The result is reasonable.

```{r}
pub_rank_10 <- pub_rank_10 %>% select(Publisher, mean_sale_publisher)
video_game_pub_rank <- left_join(video_game, pub_rank_10, by = 'Publisher')
video_game_pub_rank <- video_game_pub_rank %>% filter(mean_sale_publisher > 0.90)
video_game_pub_rank %>% ggplot(aes(x = Publisher, y = Global_Sales)) + geom_boxplot()

video_game_pub_rank <- video_game_pub_rank %>% mutate(nintendo_or_not = if_else(Publisher != 'Nintendo', 'Others', 'Nintendo'))
lm1 <- lm(Global_Sales ~ nintendo_or_not, data = video_game_pub_rank)
summary(lm1)

```

In addition, from the boxplot, we can see that Nintendo sells the most best selling games. And by the linear regression model, we can know that the average sell of Nintendo's games is absolutely higher than the average sell of other publishers' games. 

# What is the most popular game and platform each year?

We have already discussed the most






